activationtype=on_off
casttarget.casttargets=caster
resourcecosttype=adrenaline
resourcecost.values=1.00,0
castconditions=min_time_since_last_hit(5.00)
cooldown.values=1.00,0
unpausecooldownstateid=postcast
commandbodyregionlevel=0
flags=toggle,instant_cast,caster_can_move
tags=self,surprise,armor_skill

aiinfo.aicategory=dont_cast

statecount=5
state[0].id=cast

state[1].id=stealth
state[1].conditions=needs_caster_flag(cloaked),target_group_must_be_empty(0),needs_resource(1)
state[1].duration.values=-1.00,0
state[1].flags=check_command

state[2].id=presurprise
state[2].conditions=surprise_bonus(0)

state[3].id=surprise
state[3].duration.values=3.00,0
state[3].duration.boosts=attack_duration_bonus(1.00),surprise_duration_bonus(*1.00)
state[3].recalcduration=1

state[4].id=postcast

targetgroupcount=1
targetgroup[0].targettype=event_targets
targetgroup[0].event=attack

actioncount=9
action[0].type=set_flag
action[0].stateids=cast,stealth
action[0].timer.maxrefreshcount.values=1,0
action[0].targettype=caster
action[0].soldierflag=cloaked
action[0].usesourceid=0

action[1].type=set_flag
action[1].stateids=cast,stealth
action[1].timer.maxrefreshcount.values=1,0
action[1].targettype=caster
action[1].soldierflag=no_resource_regen

action[2].type=boost
action[2].stateids=stealth
action[2].boostid=moving
action[2].boost.values=1.00,0
action[2].boosttype=moving

action[3].type=resource
action[3].stateids=stealth
action[3].timer.period.values=1.00,0
action[3].targettype=caster
action[3].resource.values=-1.00,0
action[3].resource.boosts=moving(*1.00)


action[4].type=boost
action[4].stateids=presurprise
action[4].boostid=attack_duration_bonus
action[4].boost.values=3.00,0
action[4].boost.boosts=surprise_duration_bonus(*1.00)

action[5].type=set_flag
action[5].stateids=surprise
action[5].timer.maxrefreshcount.values=1,0
action[5].targettype=caster
action[5].soldierflag=ambushing
action[5].tag=surprise



action[6].type=create_magic
action[6].stateids=surprise
action[6].timer.maxrefreshcount.values=1,0
action[6].targettype=caster
action[6].skill=Surprise
action[6].optionalboostid=surprise_duration
action[6].optionalboosttype=current_state_duration
action[6].eothandling=only_one
action[6].tag=surprise


action[7].type=fmod_sound
action[7].stateids=stealth
action[7].timer.maxrefreshcount.values=1,0
action[7].targettype=caster
action[7].attachtotarget=1
action[7].eventname=event:/shield/stealth_field_on

action[8].type=fmod_sound
action[8].stateids=surprise_0,surprise_1,postcast
action[8].timer.maxrefreshcount.values=1,0
action[8].targettype=caster
action[8].attachtotarget=1
action[8].eventname=event:/shield/stealth_field_off
